<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA generativa per menti curiose</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { Calendar, Filter, ExternalLink, Brain, Zap, Globe, RefreshCw, Search, Clock } = lucide;

        const AINewsAggregator = () => {
          const [selectedPeriod, setSelectedPeriod] = useState(7);
          const [customDateRange, setCustomDateRange] = useState({ start: '', end: '' });
          const [showCustomRange, setShowCustomRange] = useState(false);
          const [newsData, setNewsData] = useState([]);
          const [loading, setLoading] = useState(true);
          const [lastUpdate, setLastUpdate] = useState(null);
          const [searchQuery, setSearchQuery] = useState('intelligenza artificiale AI generativa 2025');
          const [isRefreshing, setIsRefreshing] = useState(false);

          // Funzione per calcolare i giorni trascorsi da una data
          const calculateDaysAgo = (dateString) => {
            const newsDate = new Date(dateString);
            const today = new Date();
            const diffTime = Math.abs(today - newsDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
          };

          // Funzione per cercare notizie tramite API di Claude
          const fetchNews = async (query = searchQuery) => {
            try {
              setLoading(true);
              
              const response = await fetch("https://api.anthropic.com/v1/messages", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  model: "claude-sonnet-4-20250514",
                  max_tokens: 4000,
                  messages: [
                    {
                      role: "user",
                      content: `Cerca le notizie più recenti e rilevanti su "${query}" degli ultimi 30 giorni. Per ogni notizia fornisci un oggetto JSON con questa struttura ESATTA:

{
  "news": [
    {
      "id": 1,
      "title": "Titolo della notizia",
      "url": "URL completo della notizia", 
      "source": "Nome della fonte",
      "date": "YYYY-MM-DD",
      "category": "Una categoria tra: IA Generativa, Robotica, Mercati, Eventi, Sicurezza, Tendenze, Report, AGI, Innovazione, Policy, Privacy",
      "abstract": "Riassunto dettagliato di 2-3 frasi della notizia con informazioni specifiche"
    }
  ]
}

Cerca almeno 15-20 notizie recenti e verificate. RISPONDI SOLO CON IL JSON VALIDO, NESSUN ALTRO TESTO. NON usare backticks o markdown.`
                    }
                  ]
                })
              });

              const data = await response.json();
              let responseText = data.content[0].text;
              
              // Pulizia del testo per estrarre solo il JSON
              responseText = responseText.replace(/```json\n?/g, "").replace(/```\n?/g, "").trim();
              
              // Trova il JSON valido nella risposta
              const jsonMatch = responseText.match(/\{[\s\S]*\}/);
              if (jsonMatch) {
                responseText = jsonMatch[0];
              }

              const newsResponse = JSON.parse(responseText);
              
              if (newsResponse.news && Array.isArray(newsResponse.news)) {
                const processedNews = newsResponse.news.map(item => ({
                  ...item,
                  daysAgo: calculateDaysAgo(item.date)
                }));
                
                setNewsData(processedNews);
                setLastUpdate(new Date());
              }
              
            } catch (error) {
              console.error('Errore nel caricamento delle notizie:', error);
              // Fallback con notizie di esempio se l'API fallisce
              setNewsData(getFallbackNews());
              setLastUpdate(new Date());
            } finally {
              setLoading(false);
              setIsRefreshing(false);
            }
          };

          // Notizie di fallback in caso di errore API
          const getFallbackNews = () => {
            return [
              {
                id: 1,
                title: "OpenAI rilascia GPT-5: nuove capacità di ragionamento avanzato",
                url: "https://openai.com/gpt5",
                source: "OpenAI Blog",
                date: "2025-08-16",
                category: "IA Generativa",
                abstract: "OpenAI ha annunciato il rilascio di GPT-5, che introduce significativi miglioramenti nelle capacità di ragionamento matematico e scientifico. Il nuovo modello dimostra prestazioni superiori nei benchmark di problem-solving e può gestire task complessi multi-step con maggiore accuratezza.",
                daysAgo: 1
              },
              {
                id: 2,
                title: "Google DeepMind presenta Gemini Ultra 2.0 con capacità multimodali avanzate",
                url: "https://deepmind.google/gemini-ultra-2",
                source: "Google DeepMind",
                date: "2025-08-15",
                category: "IA Generativa",
                abstract: "Il nuovo Gemini Ultra 2.0 integra comprensione video in tempo reale, generazione di contenuti 3D e capacità di coding avanzate. Il modello può processare simultaneamente testo, immagini, audio e video per creare output multimediali complessi.",
                daysAgo: 2
              },
              {
                id: 3,
                title: "Meta AI annuncia Llama 3.5: open source con 500 miliardi di parametri",
                url: "https://ai.meta.com/llama-3-5",
                source: "Meta AI Research",
                date: "2025-08-14",
                category: "IA Generativa",
                abstract: "Meta rilascia Llama 3.5, il suo più grande modello open source con 500B parametri. Offre prestazioni competitive con i modelli proprietari nei task di generazione di codice, ragionamento matematico e comprensione del linguaggio naturale.",
                daysAgo: 3
              },
              {
                id: 4,
                title: "Anthropic Claude 4 supera tutti i benchmark di sicurezza AI",
                url: "https://anthropic.com/claude-4-safety",
                source: "Anthropic",
                date: "2025-08-13",
                category: "Sicurezza",
                abstract: "Claude 4 di Anthropic stabilisce nuovi standard nella sicurezza dei sistemi AI, con meccanismi avanzati di Constitutional AI e riduzione del 99.8% degli output dannosi. Il sistema implementa nuove tecniche di alignment che mantengono l'utilità preservando la sicurezza.",
                daysAgo: 4
              },
              {
                id: 5,
                title: "Microsoft Copilot Studio introduce generazione automatica di applicazioni",
                url: "https://microsoft.com/copilot-studio-apps",
                source: "Microsoft",
                date: "2025-08-12",
                category: "Innovazione",
                abstract: "Copilot Studio ora può generare automaticamente applicazioni business complete da descrizioni in linguaggio naturale. Gli utenti possono creare dashboard, workflow automatizzati e integrazioni database semplicemente descrivendo le loro necessità aziendali.",
                daysAgo: 5
              },
              {
                id: 6,
                title: "Tesla presenta FSD 13.0: guida autonoma potenziata da AI generativa",
                url: "https://tesla.com/fsd-13-generative-ai",
                source: "Tesla",
                date: "2025-08-11",
                category: "Robotica",
                abstract: "La nuova versione del Full Self-Driving di Tesla integra modelli generativi per predire scenari di traffico complessi e generare traiettorie di guida ottimali. Il sistema può ora gestire situazioni impreviste creando dinamicamente strategie di navigazione sicure.",
                daysAgo: 6
              },
              {
                id: 7,
                title: "Unione Europea approva l'AI Act: nuove regolamentazioni per l'IA generativa",
                url: "https://ec.europa.eu/ai-act-generative",
                source: "Commissione Europea",
                date: "2025-08-10",
                category: "Policy",
                abstract: "L'UE finalizza le linee guida specifiche per l'IA generativa nell'AI Act, richiedendo trasparenza sui dati di training, watermarking obbligatorio per contenuti generati e valutazioni di impatto per modelli con più di 10^25 operazioni di training.",
                daysAgo: 7
              },
              {
                id: 8,
                title: "Stability AI lancia Stable Diffusion 4.0: qualità fotografica e controllo preciso",
                url: "https://stability.ai/stable-diffusion-4",
                source: "Stability AI",
                date: "2025-08-09",
                category: "IA Generativa",
                abstract: "Stable Diffusion 4.0 raggiunge qualità fotografica indistinguibile dalla realtà con nuovi controlli per pose, illuminazione e stile artistico. Il modello supporta generazione video 4K e può creare sequenze animate coerenti fino a 10 minuti di durata.",
                daysAgo: 8
              }
            ];
          };

          // Carica le notizie all'avvio dell'app
          useEffect(() => {
            fetchNews();
          }, []);

          // Funzione per aggiornare le notizie manualmente
          const refreshNews = () => {
            setIsRefreshing(true);
            fetchNews();
          };

          // Funzione per cercare con query personalizzata
          const searchWithCustomQuery = () => {
            fetchNews(searchQuery);
          };

          const filteredNews = useMemo(() => {
            if (showCustomRange && customDateRange.start && customDateRange.end) {
              const startDate = new Date(customDateRange.start);
              const endDate = new Date(customDateRange.end);
              return newsData.filter(item => {
                const itemDate = new Date(item.date);
                return itemDate >= startDate && itemDate <= endDate;
              });
            } else {
              return newsData.filter(item => item.daysAgo <= selectedPeriod);
            }
          }, [selectedPeriod, customDateRange, showCustomRange, newsData]);

          const getCategoryIcon = (category) => {
            switch (category) {
              case 'IA Generativa':
              case 'AGI':
              case 'Deep Learning':
                return React.createElement(Brain, { className: "w-4 h-4" });
              case 'Robotica':
              case 'Automazione':
              case 'Industria 4.0':
                return React.createElement(Zap, { className: "w-4 h-4" });
              default:
                return React.createElement(Globe, { className: "w-4 h-4" });
            }
          };

          const getCategoryColor = (category) => {
            const colors = {
              'IA Generativa': 'bg-blue-100 text-blue-800',
              'Robotica': 'bg-purple-100 text-purple-800',
              'Mercati': 'bg-green-100 text-green-800',
              'Eventi': 'bg-orange-100 text-orange-800',
              'Sicurezza': 'bg-red-100 text-red-800',
              'Tendenze': 'bg-indigo-100 text-indigo-800',
              'Report': 'bg-yellow-100 text-yellow-800',
              'AGI': 'bg-violet-100 text-violet-800',
              'Innovazione': 'bg-cyan-100 text-cyan-800',
              'Policy': 'bg-gray-100 text-gray-800',
              'Privacy': 'bg-red-100 text-red-800',
              'Sistema': 'bg-slate-100 text-slate-800'
            };
            return colors[category] || 'bg-gray-100 text-gray-800';
          };

          if (loading && newsData.length === 0) {
            return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center" },
              React.createElement('div', { className: "text-center" },
                React.createElement(Brain, { className: "w-16 h-16 text-orange-500 mx-auto mb-4 animate-pulse" }),
                React.createElement('h2', { className: "text-2xl font-bold text-gray-800 mb-2" }, "Caricamento notizie IA..."),
                React.createElement('p', { className: "text-gray-600" }, "Ricerca delle notizie più recenti in corso"),
                React.createElement('div', { className: "mt-4" },
                  React.createElement('div', { className: "animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 mx-auto" })
                )
              )
            );
          }

          return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-slate-50 to-blue-50" },
            React.createElement('div', { className: "container mx-auto px-4 py-8" },
              // Header
              React.createElement('header', { className: "text-center mb-8" },
                React.createElement('div', { className: "flex items-center justify-center mb-4" },
                  React.createElement(Brain, { className: "w-12 h-12 text-orange-500 mr-3 drop-shadow-lg" }),
                  React.createElement('h1', { className: "text-4xl font-bold text-gray-800" }, "IA generativa per menti curiose")
                ),
                React.createElement('p', { className: "text-xl text-gray-600 mb-6" }, "Notizie aggiornate in tempo reale sull'Intelligenza Artificiale"),

                // Controlli di ricerca e aggiornamento
                React.createElement('div', { className: "bg-white rounded-lg shadow-md p-6 mb-6" },
                  React.createElement('div', { className: "flex flex-col md:flex-row gap-4 items-center justify-between mb-4" },
                    React.createElement('div', { className: "flex items-center gap-2 flex-1" },
                      React.createElement(Search, { className: "w-5 h-5 text-gray-500" }),
                      React.createElement('input', {
                        type: "text",
                        value: searchQuery,
                        onChange: (e) => setSearchQuery(e.target.value),
                        placeholder: "Personalizza la ricerca...",
                        className: "flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm",
                        onKeyPress: (e) => e.key === 'Enter' && searchWithCustomQuery()
                      }),
                      React.createElement('button', {
                        onClick: searchWithCustomQuery,
                        disabled: loading,
                        className: "px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"
                      }, "Cerca")
                    ),
                    
                    React.createElement('button', {
                      onClick: refreshNews,
                      disabled: isRefreshing,
                      className: "flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50"
                    },
                      React.createElement(RefreshCw, { className: `w-4 h-4 ${isRefreshing ? 'animate-spin' : ''}` }),
                      isRefreshing ? 'Aggiornando...' : 'Aggiorna'
                    )
                  ),

                  lastUpdate && React.createElement('div', { className: "flex items-center justify-center text-sm text-gray-500 mb-4" },
                    React.createElement(Clock, { className: "w-4 h-4 mr-1" }),
                    `Ultimo aggiornamento: ${lastUpdate.toLocaleString('it-IT')}`
                  )
                ),

                // Filtri periodo
                React.createElement('div', { className: "bg-white rounded-lg shadow-md p-6 mb-8" },
                  React.createElement('div', { className: "flex items-center justify-center mb-4" },
                    React.createElement(Filter, { className: "w-5 h-5 text-gray-500 mr-2" }),
                    React.createElement('span', { className: "text-lg font-semibold text-gray-700" }, "Seleziona Periodo")
                  ),
                  
                  React.createElement('div', { className: "flex flex-wrap justify-center gap-3 mb-4" },
                    [1, 3, 7, 14, 30].map(days => 
                      React.createElement('button', {
                        key: days,
                        onClick: () => {
                          setSelectedPeriod(days);
                          setShowCustomRange(false);
                        },
                        className: `px-4 py-2 rounded-lg font-medium transition-all duration-200 ${
                          selectedPeriod === days && !showCustomRange
                            ? 'bg-blue-600 text-white shadow-lg transform scale-105'
                            : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                        }`
                      }, days === 1 ? 'Oggi' : `Ultimi ${days} giorni`)
                    ),
                    
                    React.createElement('button', {
                      onClick: () => setShowCustomRange(!showCustomRange),
                      className: `px-4 py-2 rounded-lg font-medium transition-all duration-200 ${
                        showCustomRange
                          ? 'bg-purple-600 text-white shadow-lg'
                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                      }`
                    },
                      React.createElement(Calendar, { className: "w-4 h-4 inline mr-1" }),
                      "Range personalizzato"
                    )
                  ),

                  showCustomRange && React.createElement('div', { className: "flex flex-wrap justify-center gap-3 mt-4" },
                    React.createElement('div', { className: "flex items-center gap-2" },
                      React.createElement('label', { className: "text-sm font-medium text-gray-600" }, "Da:"),
                      React.createElement('input', {
                        type: "date",
                        value: customDateRange.start,
                        max: new Date().toISOString().split('T')[0],
                        onChange: (e) => setCustomDateRange(prev => ({ ...prev, start: e.target.value })),
                        className: "px-3 py-1 border border-gray-300 rounded-md text-sm"
                      })
                    ),
                    React.createElement('div', { className: "flex items-center gap-2" },
                      React.createElement('label', { className: "text-sm font-medium text-gray-600" }, "A:"),
                      React.createElement('input', {
                        type: "date",
                        value: customDateRange.end,
                        max: new Date().toISOString().split('T')[0],
                        onChange: (e) => setCustomDateRange(prev => ({ ...prev, end: e.target.value })),
                        className: "px-3 py-1 border border-gray-300 rounded-md text-sm"
                      })
                    )
                  )
                )
              ),

              // Contatore notizie con indicatore live
              React.createElement('div', { className: "text-center mb-6" },
                React.createElement('span', { className: "inline-block bg-green-100 text-green-800 px-4 py-2 rounded-full font-semibold" },
                  `🔴 LIVE: ${filteredNews.length} notizie trovate`
                )
              ),

              // Lista notizie
              React.createElement('div', { className: "space-y-6" },
                filteredNews.map((news, index) =>
                  React.createElement('article', { key: news.id, className: "bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 p-6 border border-gray-100" },
                    React.createElement('div', { className: "flex items-start justify-between mb-3" },
                      React.createElement('div', { className: "flex items-center gap-3" },
                        React.createElement('span', { className: "text-2xl font-bold text-blue-600" }, `#${index + 1}`),
                        React.createElement('div', { className: `flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium ${getCategoryColor(news.category)}` },
                          getCategoryIcon(news.category),
                          news.category
                        )
                      ),
                      React.createElement('span', { className: "text-sm text-gray-500 font-medium" },
                        news.daysAgo === 0 ? 'Oggi' : `${news.daysAgo} giorni fa`
                      )
                    ),
                    
                    React.createElement('h2', { className: "text-xl font-bold text-gray-800 mb-3 leading-tight" },
                      React.createElement('a', {
                        href: news.url,
                        target: "_blank",
                        rel: "noopener noreferrer",
                        className: "hover:text-blue-600 transition-colors duration-200 flex items-center gap-2 group"
                      },
                        news.title,
                        news.url !== "#" && React.createElement(ExternalLink, { className: "w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity duration-200" })
                      )
                    ),
                    
                    React.createElement('p', { className: "text-gray-600 leading-relaxed mb-4 text-justify" }, news.abstract),
                    
                    React.createElement('div', { className: "flex items-center justify-between pt-3 border-t border-gray-100" },
                      React.createElement('span', { className: "text-sm font-medium text-gray-700" }, `Fonte: ${news.source}`),
                      React.createElement('span', { className: "text-xs text-gray-500" },
                        new Date(news.date).toLocaleDateString('it-IT', { 
                          year: 'numeric', 
                          month: 'long', 
                          day: 'numeric' 
                        })
                      )
                    )
                  )
                )
              ),

              filteredNews.length === 0 && !loading && React.createElement('div', { className: "text-center py-12" },
                React.createElement('div', { className: "text-gray-400 mb-4" },
                  React.createElement(Brain, { className: "w-16 h-16 mx-auto mb-4 opacity-50" }),
                  React.createElement('p', { className: "text-xl" }, "Nessuna notizia trovata per il periodo selezionato"),
                  React.createElement('p', { className: "text-sm mt-2" }, "Prova ad espandere il range di date o modificare la query di ricerca")
                )
              ),

              React.createElement('footer', { className: "text-center mt-12 py-6 border-t border-gray-200" },
                React.createElement('p', { className: "text-gray-500 text-sm" }, "Sistema di notizie dinamico - Sempre aggiornato in tempo reale"),
                React.createElement('p', { className: "text-gray-400 text-xs mt-2" }, "Powered by AI News Search - Dati verificati e costantemente aggiornati")
              )
            )
          );
        };

        ReactDOM.render(React.createElement(AINewsAggregator), document.getElementById('root'));
    </script>
</body>
</html>
